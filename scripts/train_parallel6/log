/home/aber/unimol-mindspore/.venv/lib/python3.9/site-packages/numpy/core/getlimits.py:500: UserWarning: The value of the smallest subnormal for <class 'numpy.float64'> type is zero.
  setattr(self, word, getattr(machar, word).flat[0])
/home/aber/unimol-mindspore/.venv/lib/python3.9/site-packages/numpy/core/getlimits.py:89: UserWarning: The value of the smallest subnormal for <class 'numpy.float64'> type is zero.
  return self._float_to_str(self.smallest_subnormal)
/home/aber/unimol-mindspore/.venv/lib/python3.9/site-packages/numpy/core/getlimits.py:500: UserWarning: The value of the smallest subnormal for <class 'numpy.float32'> type is zero.
  setattr(self, word, getattr(machar, word).flat[0])
/home/aber/unimol-mindspore/.venv/lib/python3.9/site-packages/numpy/core/getlimits.py:89: UserWarning: The value of the smallest subnormal for <class 'numpy.float32'> type is zero.
  return self._float_to_str(self.smallest_subnormal)
{}
{'accuracy_mode': 'O3',
 'atoms_vocab_path': 'atom_vocab.txt',
 'backend_name': 'HCCL',
 'batch_size': 16,
 'beta': 1.0,
 'beta1': 0.9,
 'beta2': 0.99,
 'checkpoint_path': './checkpoints',
 'checkpoint_url': '',
 'coords_loss_coef': 5.0,
 'coords_noise_coef': 3.0,
 'coords_noise_type': 'uniform',
 'data_url': '',
 'dataset_sink_mode': False,
 'device_num': 8,
 'device_target': 'Ascend',
 'distance_loss_coef': 10.0,
 'dropout': 0.9,
 'enable_modelarts': False,
 'encoder_attention_heads': 64,
 'encoder_emb_dim': 512,
 'encoder_ff_emb_dim': 2048,
 'encoder_layers': 15,
 'epochs': 7,
 'eps': 1e-06,
 'eval': True,
 'eval_lmdb_dataset_path': '/media/datasets/datasets/unimol_datasets/ligands/valid.lmdb',
 'gaus_kernel_channels': 128,
 'keep_checkpoint_max': 15,
 'max_atoms': 512,
 'max_seq_len': 256,
 'max_steps': 1000000,
 'mode': 'GRAPH',
 'num_parallel_workers': 2,
 'optimizer': 'adam',
 'output_path': './output',
 'parameter_server': False,
 'peak_lr': 0.0001,
 'prob_mask': 0.15,
 'prob_random_token': 0.15,
 'prob_unmask': 0.15,
 'python_multiprocessing': False,
 'reduction': 'mean',
 'remove_hydrogen': '',
 'run_distribute': False,
 'save_checkpoint': True,
 'save_checkpoint_steps': 1,
 'seed': 42,
 'task': 'molecule_pretrain',
 'token_loss_coef': 1.0,
 'train_lmdb_dataset_path': '/media/datasets/datasets/unimol_datasets/ligands/train.lmdb',
 'train_url': '',
 'use_cache': False,
 'warmup_steps': 10000,
 'weight_decay': 0.0001}
/home/aber/unimol-mindspore/scripts/train_parallel6
epoch: 1 step: 1, loss is 13.84
epoch: 1 step: 2, loss is 14.03
